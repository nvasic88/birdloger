(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{H1H1:function(e,t,r){"use strict";r.r(t);var o=r("5YJQ"),s=r.n(o),a=r("JkKK"),n=r("mwIZ"),i=r.n(n),l=r("J2m7"),c=r.n(l),u=r("ijCd"),d=r.n(u),f=r("UfWW"),m=r.n(f),p=r("wEy/"),b=r.n(p),v=r("BkRI"),h=r.n(v),_=r("mk2N"),g=r("gKG+"),y=r("KUSn"),x=r("nWYc"),C=r("l90O"),w=r("uuKk"),k=r("WYMz");function O(e){return function(e){if(Array.isArray(e))return T(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var $={name:"nzFieldObservationForm",mixins:[_.a,g.a],components:{NzDateInput:y.a,NzPhotoUpload:x.a,NzSpatialInput:C.a,NzTaxonAutocomplete:w.a,NzUserAutocomplete:k.a},props:{observation:{type:Object,default:function(){return{taxon:null,taxon_id:null,taxon_suggestion:"",year:Object(a.a)().year(),month:Object(a.a)().month()+1,day:Object(a.a)().date(),latitude:null,longitude:null,accuracy:null,elevation:null,location:"",photos:[],observer:"",identifier:"",note:"",sex:null,number:null,number_of:"individual",project:null,habitat:null,found_on:null,stage_id:null,found_dead:!1,found_dead_note:"",data_license:null,image_license:null,time_of_departure:null,time_of_arrival:null,types:[],observers:[],field_observers:[],observed_by_id:null,observed_by:null,identified_by_id:null,identified_by:null,dataset:null,atlas_code:null,description:"",comment:"",data_provider:"",data_limit:"",position:null,state:null,annotation:"",number_of_pillars:null,distance_from_pillar:null,transmission_line:null,age:null,duration:null,distance:null,transportation:null}}},licenses:{type:Object,default:function(){return{}}},sexes:{type:Object,default:function(){return{}}},observationTypes:{type:Array,default:function(){return[]}},stages:{type:Array,default:function(){return[]}},showObserverIdentifier:Boolean,fieldObservers:{type:Array,default:function(){return[]}},atlasCodes:Array},data:function(){return{keepAfterSubmit:this.getAttributesToKeep(),showMoreDetails:!0,locale:window.App.locale,observationTypeSearch:"",shouldClearType:!1,exifExtracted:!1,lastStageId:this.observation.stage_id,observers:this.observation.observers,observerFirstName:"",observerLastName:"",observerErrors:{type:Array,default:function(){return[]}}}},computed:{time_of_departure:function(){return this.form.time_of_departure?Object(a.a)(this.form.time_of_departure,"HH:mm").toDate():null},time_of_arrival:function(){return this.form.time_of_arrival?Object(a.a)(this.form.time_of_arrival,"HH:mm").toDate():null},selectedObservationTypes:{get:function(){var e=this;return this.observationTypes.filter((function(t){return d()(e.form.observation_types_ids,t.id)}))},set:function(e){this.form.observation_types_ids=e.map((function(e){return e.id}))}},availableObservationTypes:function(){var e=this;return this.observationTypes.filter((function(t){return!d()(e.form.observation_types_ids,t.id)&&t.name.toLowerCase().includes(e.observationTypeSearch.toLowerCase())}))},isIdentified:function(){return!(!this.form.taxon_id&&!this.form.taxon_suggestion)},identificationChanged:function(){return this.form.taxon_id!==this.observation.taxon_id||this.form.taxon_suggestion!==this.observation.taxon_suggestion}},created:function(){this.setDefaultObservationType()},methods:{newForm:function(){var e=this.observation;return e.photos.forEach((function(e){e.crop=null})),new s.a(E(E({},e),{},{observation_types_ids:e.types.map((function(e){return e.id})),observers:this.observation.observers,reason:null,field_observers:this.fieldObservers}),{resetOnSuccess:!1})},checkForm:function(){if(this.observerFirstName&&this.observerLastName)return!0},addObserver:function(){this.observerFirstName&&this.observerLastName?(this.fieldObservers.push({firstName:this.observerFirstName,lastName:this.observerLastName}),this.observerFirstName=null,this.observerLastName=null,this.observerErrors=[]):(this.observerFirstName||(this.observerErrors.observerFirstName="This field is required",this.$forceUpdate()),this.observerLastName||(this.observerErrors.observerLastName="This field is required",this.$forceUpdate()))},removeObserver:function(e){axios.delete(route("api.observers.destroy",this.observers[e])),this.$delete(this.observers,e)},hookAfterSubmitWithoutRedirect:function(){this.setDefaultObservationType(),this.clearPhotos(),this.$refs.taxonAutocomplete.focusOnInput()},clearPhotos:function(){var e=this;[1,2,3].forEach((function(t){e.$refs["photoUpload-".concat(t)].clearPhoto()}))},onTaxonSelect:function(e){var t=this;this.form.taxon=e||null,this.form.taxon_id=e?e.id:null,this.form.taxon_suggestion=e?e.name:null;var r=this.lastStageId&&!c()(this.stages,(function(e){return e.id===t.lastStageId}));this.form.stage_id=r?null:this.lastStageId,this.updateIdentifier()},onDepartureTimeInput:function(e){this.form.time_of_departure=e?Object(a.a)(e).format("HH:mm"):null},onArrivalTimeInput:function(e){this.form.time_of_arrival=e?Object(a.a)(e).format("HH:mm"):null},onPhotoUploaded:function(e){this.form.photos.push({path:e.path,crop:e.crop,license:e.license});var t=c()(this.availableObservationTypes,{slug:"photographed"});t&&this.pushSelectedObservationType(t),this.promptToExtractExifData(e)},onPhotoRemoved:function(e){b()(this.form.photos,{path:e.path});var t=m()(this.selectedObservationTypes,{slug:"photographed"});if(!this.form.photos.length&&t>=0){var r=this.selectedObservationTypes;r.splice(t,1),this.selectedObservationTypes=r}},onPhotoCropped:function(e){var t=m()(this.form.photos,{path:e.path});if(t>=0){var r=h()(this.form.photos[t]);r.crop=e.crop,this.form.photos.splice(t,1,r)}},getObservationPhotoAttribute:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"url",r=i()(this.observation,"photos.".concat(e,".").concat(t),"");if("url"===t&&r){var o=Object(a.a)(i()(this.observation,"photos.".concat(e,".updated_at"),null));r+=o.isValid()?"?v=".concat(o.format("X")):""}return r},getAttributesToKeep:function(){return["location","accuracy","elevation","latitude","longitude","year","month","day","project","observer","observed_by","observed_by_id","data_license","image_license","found_dead","found_dead_note"]},onTypeTyping:function(e){this.observationTypeSearch=e},onTypeBackspace:function(){this.shouldClearType?(this.form.observation_types_ids.splice(-1,1),this.shouldClearType=!1):this.observationTypeSearch||(this.shouldClearType=!0)},pushSelectedObservationType:function(e){var t=this.selectedObservationTypes;t.push(e),this.selectedObservationTypes=t},promptToExtractExifData:function(e){var t=this;!this.exifExtracted&&e.exif&&this.$buefy.dialog.confirm({message:this.extractExifMessage(e).replace(/\n/g,"<br>"),cancelText:this.trans("No"),confirmText:this.trans("Yes"),onConfirm:function(){t.fillFromExif(e)},onCancel:function(){t.exifExtracted=!0}})},extractExifMessage:function(e){var t=this,r=this.extractExifData(e);return[this.trans("Use data from photo to fill the form?")+"\n"].concat(O(Object.keys(r).map((function(e){return"".concat(t.trans("labels.field_observations."+e),": ").concat(r[e])})))).join("\n")},extractExifData:function(e){var t={};for(var r in e.exif){var o=e.exif[r];o&&(t[r]=o)}return t},fillFromExif:function(e){var t=this.extractExifData(e);for(var r in t)this.form[r]=t[r];this.exifExtracted=!0},onObserverSelect:function(e){this.form.observed_by=e||null,this.form.observed_by_id=e?e.id:null,this.form.observer=e?e.full_name:null},onIdentifierSelect:function(e){this.form.identified_by=e||null,this.form.identified_by_id=e?e.id:null,this.form.identifier=e?e.full_name:null},setDefaultObservationType:function(){this.selectedObservationTypes.length||this.pushSelectedObservationType(c()(this.availableObservationTypes,{slug:"observed"}))},updateIdentifier:function(){var e=this.observation.identified_by;this.identificationChanged&&(e=this.isIdentified?window.App.User:null),this.onIdentifierSelect(e)},onLicenseChanged:function(e,t){var r=h()(this.form.photos[e]);r.license=t,this.form.photos[e]=r}}},I=r("KHd+"),j=Object(I.a)($,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("form",{staticClass:"electrocution-observation-form",attrs:{action:e.action,method:"POST",lang:e.locale}},[r("div",{staticClass:"columns is-desktop"},[r("div",{staticClass:"column is-half-desktop"},[r("div",{staticClass:"columns"},[r("div",{staticClass:"column is-2"},[r("b-field",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.trans("labels.observations.id_tooltip"),expression:"trans('labels.observations.id_tooltip')"}],staticClass:"is-required",attrs:{label:e.trans("labels.field_observations.taxon_id"),"label-for":"taxon_id",type:e.form.errors.has("taxon_id")?"is-danger":null,message:e.form.errors.has("taxon_id")?e.form.errors.first("taxon_id"):null}},[r("b-input",{attrs:{id:"taxon_id",type:"number",disabled:"disabled"},model:{value:e.form.taxon_id,callback:function(t){e.$set(e.form,"taxon_id",t)},expression:"form.taxon_id"}})],1)],1),e._v(" "),r("div",{staticClass:"column"},[r("nz-taxon-autocomplete",{ref:"taxonAutocomplete",staticClass:"is-required",attrs:{taxon:e.observation.taxon,error:e.form.errors.has("taxon_id"),message:e.form.errors.has("taxon_id")?e.form.errors.first("taxon_id"):null,autofocus:"",label:e.trans("labels.field_observations.taxon"),placeholder:e.trans("labels.field_observations.search_for_taxon")},on:{select:e.onTaxonSelect},model:{value:e.form.taxon_suggestion,callback:function(t){e.$set(e.form,"taxon_suggestion",t)},expression:"form.taxon_suggestion"}})],1)]),e._v(" "),r("nz-date-input",{attrs:{year:e.form.year,month:e.form.month,day:e.form.day,errors:e.form.errors,label:e.trans("labels.field_observations.date"),placeholders:{year:e.trans("labels.field_observations.year"),month:e.trans("labels.field_observations.month"),day:e.trans("labels.field_observations.day")}},on:{"update:year":function(t){return e.$set(e.form,"year",t)},"update:month":function(t){return e.$set(e.form,"month",t)},"update:day":function(t){return e.$set(e.form,"day",t)}}}),e._v(" "),r("b-field",{attrs:{label:e.trans("labels.field_observations.photos")}},[r("div",{staticClass:"columns"},[r("div",{staticClass:"column is-one-third"},[r("nz-photo-upload",{ref:"photoUpload-1",attrs:{"image-url":e.getObservationPhotoAttribute(0,"url"),"image-path":e.getObservationPhotoAttribute(0,"path"),"image-license":e.getObservationPhotoAttribute(0,"license"),licenses:e.licenses,text:e.trans("labels.field_observations.upload"),errors:e.form.errors},on:{uploaded:e.onPhotoUploaded,removed:e.onPhotoRemoved,cropped:e.onPhotoCropped,"license-changed":function(t){return e.onLicenseChanged(0,t)}}})],1),e._v(" "),r("div",{staticClass:"column is-one-third"},[r("nz-photo-upload",{ref:"photoUpload-2",attrs:{"image-url":e.getObservationPhotoAttribute(1,"url"),"image-path":e.getObservationPhotoAttribute(1,"path"),"image-license":e.getObservationPhotoAttribute(1,"license"),licenses:e.licenses,text:e.trans("labels.field_observations.upload"),errors:e.form.errors},on:{uploaded:e.onPhotoUploaded,removed:e.onPhotoRemoved,cropped:e.onPhotoCropped,"license-changed":function(t){return e.onLicenseChanged(1,t)}}})],1),e._v(" "),r("div",{staticClass:"column is-one-third"},[r("nz-photo-upload",{ref:"photoUpload-3",attrs:{"image-url":e.getObservationPhotoAttribute(2,"url"),"image-path":e.getObservationPhotoAttribute(2,"path"),"image-license":e.getObservationPhotoAttribute(2,"license"),licenses:e.licenses,text:e.trans("labels.field_observations.upload"),errors:e.form.errors},on:{uploaded:e.onPhotoUploaded,removed:e.onPhotoRemoved,cropped:e.onPhotoCropped,"license-changed":function(t){return e.onLicenseChanged(2,t)}}})],1)])])],1),e._v(" "),r("div",{staticClass:"column is-half-desktop"},[r("nz-spatial-input",{attrs:{latitude:e.form.latitude,longitude:e.form.longitude,location:e.form.location,accuracy:e.form.accuracy,elevation:e.form.elevation,errors:e.form.errors},on:{"update:latitude":function(t){return e.$set(e.form,"latitude",t)},"update:longitude":function(t){return e.$set(e.form,"longitude",t)},"update:location":function(t){return e.$set(e.form,"location",t)},"update:accuracy":function(t){return e.$set(e.form,"accuracy",t)},"update:elevation":function(t){return e.$set(e.form,"elevation",t)}}})],1)]),e._v(" "),r("button",{staticClass:"button is-text",attrs:{type:"button"},on:{click:function(t){e.showMoreDetails=!e.showMoreDetails}}},[e._v("\n    "+e._s(e.showMoreDetails?e.trans("labels.field_observations.less_details"):e.trans("labels.field_observations.more_details"))+"\n  ")]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.showMoreDetails,expression:"showMoreDetails"}],staticClass:"mt-4"},[r("div",{staticClass:"columns"},[r("div",{staticClass:"column"},[r("b-field",{attrs:{label:e.trans("labels.field_observations.stage"),"label-for":"stage",type:e.form.errors.has("stage_id")?"is-danger":null,message:e.form.errors.has("stage_id")?e.form.errors.first("stage_id"):null}},[r("b-select",{attrs:{id:"stage",disabled:!e.stages.length,expanded:""},on:{input:function(t){e.lastStageId=t}},model:{value:e.form.stage_id,callback:function(t){e.$set(e.form,"stage_id",t)},expression:"form.stage_id"}},[r("option",{domProps:{value:null}},[e._v(e._s(e.trans("labels.field_observations.choose_a_stage")))]),e._v(" "),e._l(e.stages,(function(t){return r("option",{key:t.id,domProps:{value:t.id,textContent:e._s(e.trans("stages."+t.name))}})}))],2)],1)],1),e._v(" "),r("div",{staticClass:"column"},[r("b-field",{attrs:{label:e.trans("labels.field_observations.sex"),type:e.form.errors.has("sex")?"is-danger":null,message:e.form.errors.has("sex")?e.form.errors.first("sex"):null}},[r("b-select",{attrs:{expanded:""},model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[r("option",{domProps:{value:null}},[e._v(e._s(e.trans("labels.field_observations.choose_a_value")))]),e._v(" "),e._l(e.sexes,(function(t,o){return r("option",{key:o,domProps:{value:o,textContent:e._s(t)}})}))],2)],1)],1)]),e._v(" "),r("b-field",{attrs:{label:e.trans("labels.field_observations.types"),error:e.form.errors.has("observation_types_ids"),message:e.form.errors.has("observation_types_ids")?e.form.errors.first("observation_types_ids"):null}},[r("b-taginput",{attrs:{data:e.availableObservationTypes,autocomplete:"",allowNew:!1,field:"name",icon:"tag",placeholder:e.trans("labels.field_observations.types_placeholder"),"open-on-focus":""},on:{typing:e.onTypeTyping},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete","Del"])?null:e.onTypeBackspace(t)}},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.option.name))])]}}]),model:{value:e.selectedObservationTypes,callback:function(t){e.selectedObservationTypes=t},expression:"selectedObservationTypes"}})],1),e._v(" "),r("b-field",{attrs:{label:e.trans("labels.observations.atlas_code"),"label-for":"atlas-code",type:e.form.errors.has("atlas_code")?"is-danger":null,message:e.form.errors.has("atlas_code")?e.form.errors.first("atlas_code"):null}},[r("b-select",{attrs:{id:"atlas-code",expanded:""},model:{value:e.form.atlas_code,callback:function(t){e.$set(e.form,"atlas_code",t)},expression:"form.atlas_code"}},[r("option",{domProps:{value:null}},[e._v(e._s(e.trans("labels.field_observations.choose_a_value")))]),e._v(" "),e._l(e.atlasCodes,(function(t){return r("option",{key:t.code,domProps:{value:t.code,textContent:e._s(t.name)}})}))],2)],1),e._v(" "),r("div",{staticClass:"columns"},[r("div",{staticClass:"column"},[r("b-field",{attrs:{label:e.trans("labels.field_observations.number"),"label-for":"number",type:e.form.errors.has("number")?"is-danger":null,message:e.form.errors.has("number")?e.form.errors.first("number"):null}},[r("b-input",{attrs:{id:"number",type:"number"},model:{value:e.form.number,callback:function(t){e.$set(e.form,"number",t)},expression:"form.number"}})],1)],1),e._v(" "),r("div",{staticClass:"column"},[r("b-field",{attrs:{label:e.trans("labels.field_observations.number_of"),"label-for":"number_of",type:e.form.errors.has("number_of")?"is-danger":null,message:e.form.errors.has("number_of")?e.form.errors.first("number_of"):null}},[r("b-select",{attrs:{expanded:""},model:{value:e.form.number_of,callback:function(t){e.$set(e.form,"number_of",t)},expression:"form.number_of"}},[r("option",{domProps:{value:null}},[e._v(e._s(e.trans("labels.field_observations.choose_a_value")))]),e._v(" "),r("option",{attrs:{value:"individual"}},[e._v(e._s(e.trans("labels.number_of.individual")))]),e._v(" "),r("option",{attrs:{value:"couple"}},[e._v(e._s(e.trans("labels.number_of.couple")))]),e._v(" "),r("option",{attrs:{value:"singing_male"}},[e._v(e._s(e.trans("labels.number_of.singing_male")))]),e._v(" "),r("option",{attrs:{value:"active_nest"}},[e._v(e._s(e.trans("labels.number_of.active_nest")))]),e._v(" "),r("option",{attrs:{value:"family_with_cubs"}},[e._v(e._s(e.trans("labels.number_of.family_with_cubs")))])])],1)],1)]),e._v(" "),r("div",{staticClass:"columns"},[r("div",{staticClass:"column"},[r("b-field",{attrs:{label:e.trans("labels.observations.data_provider"),"label-for":"data_provider",error:e.form.errors.has("data_provider"),message:e.form.errors.has("data_provider")?e.form.errors.first("data_provider"):null}},[r("b-input",{attrs:{id:"data_provider",name:"data_provider"},model:{value:e.form.data_provider,callback:function(t){e.$set(e.form,"data_provider",t)},expression:"form.data_provider"}})],1)],1),e._v(" "),r("div",{staticClass:"column"},[r("b-field",{attrs:{label:e.trans("labels.observations.data_limit"),"label-for":"data_limit",error:e.form.errors.has("data_limit"),message:e.form.errors.has("data_limit")?e.form.errors.first("data_limit"):null}},[r("b-input",{attrs:{id:"data_limit",name:"data_limit"},model:{value:e.form.data_limit,callback:function(t){e.$set(e.form,"data_limit",t)},expression:"form.data_limit"}})],1)],1)]),e._v(" "),r("b-field",{attrs:{label:e.trans("labels.field_observations.note"),"label-for":"note",error:e.form.errors.has("note"),message:e.form.errors.has("note")?e.form.errors.first("note"):null}},[r("b-input",{attrs:{id:"note",type:"textarea"},model:{value:e.form.note,callback:function(t){e.$set(e.form,"note",t)},expression:"form.note"}})],1),e._v(" "),r("b-field",{attrs:{label:e.trans("labels.field_observations.habitat"),"label-for":"habitat",error:e.form.errors.has("habitat"),message:e.form.errors.has("habitat")?e.form.errors.first("habitat"):null}},[r("b-input",{attrs:{id:"habitat",name:"habitat"},model:{value:e.form.habitat,callback:function(t){e.$set(e.form,"habitat",t)},expression:"form.habitat"}})],1),e._v(" "),r("div",{staticClass:"columns"},[r("div",{staticClass:"column"},[r("b-field",{attrs:{label:e.trans("labels.electrocution_observations.time_of_departure"),"label-for":"time_of_departure",type:e.form.errors.has("time_of_departure")?"is-danger":null,message:e.form.errors.has("time_of_departure")?e.form.errors.first("time_of_departure"):null}},[r("b-timepicker",{attrs:{id:"time_of_departure",value:e.time_of_departure,placeholder:e.trans("labels.field_observations.click_to_select"),icon:"clock-o","mobile-native":!1},on:{input:e.onDepartureTimeInput}},[r("button",{staticClass:"button is-danger",attrs:{type:"button"},on:{click:function(t){e.form.time_of_departure=null}}},[r("b-icon",{attrs:{icon:"close"}})],1)])],1)],1),e._v(" "),r("div",{staticClass:"column"},[r("b-field",{attrs:{label:e.trans("labels.electrocution_observations.time_of_arrival"),"label-for":"time_of_arrival",type:e.form.errors.has("time_of_arrival")?"is-danger":null,message:e.form.errors.has("time_of_arrival")?e.form.errors.first("time_of_arrival"):null}},[r("b-timepicker",{attrs:{id:"time_of_arrival",value:e.time_of_arrival,placeholder:e.trans("labels.field_observations.click_to_select"),icon:"clock-o","mobile-native":!1},on:{input:e.onArrivalTimeInput}},[r("button",{staticClass:"button is-danger",attrs:{type:"button"},on:{click:function(t){e.form.time_of_arrival=null}}},[r("b-icon",{attrs:{icon:"close"}})],1)])],1)],1)]),e._v(" "),r("div",{staticClass:"columns"},[r("div",{staticClass:"column"},[r("b-field",{attrs:{label:e.trans("labels.electrocution_observations.duration"),"label-for":"duration",error:e.form.errors.has("duration"),message:e.form.errors.has("duration")?e.form.errors.first("duration"):null}},[r("b-input",{attrs:{id:"duration",type:"number"},model:{value:e.form.duration,callback:function(t){e.$set(e.form,"duration",t)},expression:"form.duration"}})],1)],1),e._v(" "),r("div",{staticClass:"column"},[r("b-field",{attrs:{label:e.trans("labels.electrocution_observations.distance"),"label-for":"distance",error:e.form.errors.has("distance"),message:e.form.errors.has("distance")?e.form.errors.first("distance"):null}},[r("b-input",{attrs:{id:"distance",type:"number"},model:{value:e.form.distance,callback:function(t){e.$set(e.form,"distance",t)},expression:"form.distance"}})],1)],1),e._v(" "),r("div",{staticClass:"column"},[r("b-field",{attrs:{label:e.trans("labels.electrocution_observations.transportation"),"label-for":"transportation",error:e.form.errors.has("transportation"),message:e.form.errors.has("transportation")?e.form.errors.first("transportation"):null}},[r("b-input",{attrs:{id:"transportation",name:"transportation"},model:{value:e.form.transportation,callback:function(t){e.$set(e.form,"transportation",t)},expression:"form.transportation"}})],1)],1)]),e._v(" "),r("b-field",{attrs:{label:e.trans("labels.field_observations.description"),"label-for":"description",error:e.form.errors.has("description"),message:e.form.errors.has("description")?e.form.errors.first("description"):null}},[r("b-input",{attrs:{id:"description",type:"textarea"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),e._v(" "),r("b-field",{attrs:{label:e.trans("labels.field_observations.comment"),"label-for":"comment",error:e.form.errors.has("comment"),message:e.form.errors.has("comment")?e.form.errors.first("comment"):null}},[r("b-input",{attrs:{id:"comment",type:"textarea"},model:{value:e.form.comment,callback:function(t){e.$set(e.form,"comment",t)},expression:"form.comment"}})],1),e._v(" "),r("div",{staticClass:"columns"},[r("div",{staticClass:"column"},[r("b-field",{attrs:{label:e.trans("labels.electrocution_observations.distance_from_pillar"),"label-for":"distance_from_pillar",error:e.form.errors.has("distance_from_pillar"),message:e.form.errors.has("distance_from_pillar")?e.form.errors.first("distance_from_pillar"):null}},[r("b-input",{attrs:{id:"distance_from_pillar",name:"distance_from_pillar",type:"number"},model:{value:e.form.distance_from_pillar,callback:function(t){e.$set(e.form,"distance_from_pillar",t)},expression:"form.distance_from_pillar"}})],1)],1),e._v(" "),r("div",{staticClass:"column"},[r("b-field",{attrs:{label:e.trans("labels.electrocution_observations.number_of_pillars"),"label-for":"number_of_pillars",error:e.form.errors.has("number_of_pillars"),message:e.form.errors.has("number_of_pillars")?e.form.errors.first("number_of_pillars"):null}},[r("b-input",{attrs:{id:"number_of_pillars",name:"number_of_pillars",type:"number"},model:{value:e.form.number_of_pillars,callback:function(t){e.$set(e.form,"number_of_pillars",t)},expression:"form.number_of_pillars"}})],1)],1),e._v(" "),r("div",{staticClass:"column"},[r("b-field",{attrs:{label:e.trans("labels.electrocution_observations.transmission_line"),"label-for":"transmission_line",error:e.form.errors.has("transmission_line"),message:e.form.errors.has("transmission_line")?e.form.errors.first("transmission_line"):null}},[r("b-input",{attrs:{id:"transmission_line",name:"transmission_line"},model:{value:e.form.transmission_line,callback:function(t){e.$set(e.form,"transmission_line",t)},expression:"form.transmission_line"}})],1)],1)]),e._v(" "),r("div",{staticClass:"columns"},[r("div",{staticClass:"column"},[r("b-field",{attrs:{label:e.trans("labels.electrocution_observations.age"),"label-for":"age",error:e.form.errors.has("age"),message:e.form.errors.has("age")?e.form.errors.first("age"):null}},[r("b-input",{attrs:{id:"age",name:"age",type:"number"},model:{value:e.form.age,callback:function(t){e.$set(e.form,"age",t)},expression:"form.age"}})],1)],1),e._v(" "),r("div",{staticClass:"column"},[r("b-field",{attrs:{label:e.trans("labels.electrocution_observations.position"),"label-for":"position",error:e.form.errors.has("position"),message:e.form.errors.has("position")?e.form.errors.first("position"):null}},[r("b-input",{attrs:{id:"position",name:"position"},model:{value:e.form.position,callback:function(t){e.$set(e.form,"position",t)},expression:"form.position"}})],1)],1),e._v(" "),r("div",{staticClass:"column"},[r("b-field",{attrs:{label:e.trans("labels.electrocution_observations.state"),"label-for":"state",error:e.form.errors.has("state"),message:e.form.errors.has("state")?e.form.errors.first("state"):null}},[r("b-input",{attrs:{id:"state",name:"state"},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}})],1)],1)]),e._v(" "),r("b-field",{attrs:{label:e.trans("labels.electrocution_observations.annotation"),"label-for":"annotation",error:e.form.errors.has("annotation"),message:e.form.errors.has("annotation")?e.form.errors.first("annotation"):null}},[r("b-input",{attrs:{id:"annotation",type:"textarea"},model:{value:e.form.annotation,callback:function(t){e.$set(e.form,"annotation",t)},expression:"form.annotation"}})],1),e._v(" "),r("div",{staticClass:"columns"},[r("div",{staticClass:"column"},[r("b-field",{attrs:{label:e.trans("labels.literature_observations.project"),type:e.form.errors.has("project")?"is-danger":null,message:e.form.errors.has("project")?e.form.errors.first("project"):null}},[r("label",{staticClass:"label",attrs:{slot:"label",for:"project"},slot:"label"},[r("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:e.trans("labels.literature_observations.project_tooltip")},expression:"{content: trans('labels.literature_observations.project_tooltip')}"}],staticClass:"is-dashed"},[e._v("\n              "+e._s(e.trans("labels.literature_observations.project"))+"\n            ")])]),e._v(" "),r("b-input",{attrs:{id:"project",name:"project"},model:{value:e.form.project,callback:function(t){e.$set(e.form,"project",t)},expression:"form.project"}})],1)],1),e._v(" "),r("div",{staticClass:"column"},[r("b-field",{attrs:{label:e.trans("labels.field_observations.dataset"),"label-for":"dataset",type:e.form.errors.has("dataset")?"is-danger":null,message:e.form.errors.has("dataset")?e.form.errors.first("dataset"):null}},[r("b-input",{attrs:{id:"dataset",name:"dataset"},model:{value:e.form.dataset,callback:function(t){e.$set(e.form,"dataset",t)},expression:"form.dataset"}})],1)],1)]),e._v(" "),r("b-checkbox",{model:{value:e.form.found_dead,callback:function(t){e.$set(e.form,"found_dead",t)},expression:"form.found_dead"}},[e._v(e._s(e.trans("labels.observations.found_dead")))]),e._v(" "),e.form.found_dead?r("b-field",{attrs:{label:e.trans("labels.observations.found_dead_note"),"label-for":"found_dead_note",error:e.form.errors.has("found_dead_note"),message:e.form.errors.has("found_dead_note")?e.form.errors.first("found_dead_note"):null}},[r("b-input",{attrs:{id:"found_dead_note",type:"textarea"},model:{value:e.form.found_dead_note,callback:function(t){e.$set(e.form,"found_dead_note",t)},expression:"form.found_dead_note"}})],1):e._e(),e._v(" "),r("hr"),e._v(" "),r("div",[r("b",[e._v(e._s(e.trans("labels.observations.observers")))])]),e._v(" "),r("div",{staticClass:"columns"},[r("div",{staticClass:"column is-2"},[r("b",[e._v(e._s(e.trans("labels.observations.firstName")))])]),e._v(" "),r("div",{staticClass:"column is-2"},[r("b",[e._v(e._s(e.trans("labels.observations.lastName")))])]),e._v(" "),r("div",{staticClass:"column is-1"})]),e._v(" "),e._l(e.observers,(function(t,o){return r("div",{key:o,staticClass:"columns"},[r("div",{staticClass:"column is-2"},[e._v(e._s(t.firstName))]),e._v(" "),r("div",{staticClass:"column is-2"},[e._v(e._s(t.lastName))]),e._v(" "),r("div",{staticClass:"column is-1"},[r("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:e.trans("labels.observations.remove_observer_tooltip")},expression:"{content: trans('labels.observations.remove_observer_tooltip')}"}],staticClass:"delete",attrs:{type:"button"},on:{click:function(t){return e.removeObserver(o)}}})])])})),e._v(" "),e._l(e.fieldObservers,(function(t,o){return r("div",{key:o,staticClass:"columns"},[r("div",{staticClass:"column is-2"},[e._v(e._s(t.firstName))]),e._v(" "),r("div",{staticClass:"column is-2"},[e._v(e._s(t.lastName))]),e._v(" "),r("div",{staticClass:"column is-1"},[r("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:e.trans("labels.observations.remove_observer_tooltip")},expression:"{content: trans('labels.observations.remove_observer_tooltip')}"}],staticClass:"delete",attrs:{type:"button"},on:{click:function(t){return e.removeObserver(o)}}})])])})),e._v(" "),r("div",{staticClass:"columns"},[r("div",{staticClass:"column is-2"},[r("b-field",{attrs:{type:e.observerErrors.observerFirstName?"is-danger":null,message:e.observerErrors.observerFirstName?e.observerErrors.observerFirstName:null}},[r("b-input",{attrs:{id:"observerFirstName",maxlength:"50",placeholder:e.trans("labels.observations.insert_first_name")},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.$refs.observerLastName.focus(t))}},model:{value:e.observerFirstName,callback:function(t){e.observerFirstName=t},expression:"observerFirstName"}})],1)],1),e._v(" "),r("div",{staticClass:"column is-2"},[r("b-field",{attrs:{type:e.observerErrors.observerLastName?"is-danger":null,message:e.observerErrors.observerLastName?e.observerErrors.observerLastName:null}},[r("b-input",{ref:"observerLastName",attrs:{id:"observerLastName",maxlength:"50",placeholder:e.trans("labels.observations.insert_last_name")},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.addObserver(t))}},model:{value:e.observerLastName,callback:function(t){e.observerLastName=t},expression:"observerLastName"}})],1)],1),e._v(" "),r("div",{staticClass:"column is-1"},[r("button",{staticClass:"button is-primary",attrs:{type:"button"},on:{click:e.addObserver}},[e._v("\n          "+e._s(e.trans("labels.observations.add_observer"))+"\n        ")])])]),e._v(" "),r("hr"),e._v(" "),e.showObserverIdentifier?[r("nz-user-autocomplete",{attrs:{error:e.form.errors.has("identifier"),message:e.form.errors.has("identifier")?e.form.errors.first("identifier"):null,user:e.form.identified_by,label:e.trans("labels.field_observations.identifier"),disabled:!e.isIdentified},on:{select:e.onIdentifierSelect},model:{value:e.form.identifier,callback:function(t){e.$set(e.form,"identifier",t)},expression:"form.identifier"}})]:e._e(),e._v(" "),r("div",{staticClass:"columns"},[r("div",{staticClass:"column"},[r("b-field",{attrs:{label:e.trans("labels.field_observations.data_license"),"label-for":"data_license",type:e.form.errors.has("data_license")?"is-danger":null,message:e.form.errors.has("data_license")?e.form.errors.first("data_license"):null}},[r("b-select",{attrs:{id:"data_license",expanded:""},model:{value:e.form.data_license,callback:function(t){e.$set(e.form,"data_license",t)},expression:"form.data_license"}},[r("option",{domProps:{value:null}},[e._v(e._s(e.trans("labels.field_observations.default")))]),e._v(" "),e._l(e.licenses,(function(t,o){return r("option",{key:o,domProps:{value:o,textContent:e._s(t)}})}))],2)],1)],1)]),e._v(" "),r("hr")],2),e._v(" "),r("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:e.trans("labels.field_observations.save_tooltip")},expression:"{content: trans('labels.field_observations.save_tooltip')}"}],staticClass:"button is-primary",class:{"is-loading":e.submittingWithRedirect},attrs:{type:"submit"},on:{click:function(t){return t.preventDefault(),e.submitWithRedirect(t)}}},[e._v("\n    "+e._s(e.trans("buttons.save"))+"\n  ")]),e._v(" "),e.submitMore?r("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:e.trans("labels.field_observations.save_more_tooltip")},expression:"{content: trans('labels.field_observations.save_more_tooltip')}"}],staticClass:"button is-primary",class:{"is-outlined":!e.submittingWithoutRedirect,"is-loading":e.submittingWithoutRedirect},attrs:{type:"submit"},on:{click:function(t){return t.preventDefault(),e.submitWithoutRedirect(t)}}},[e._v("\n    "+e._s(e.trans("buttons.save_more"))+"\n  ")]):e._e(),e._v(" "),r("a",{staticClass:"button is-text",attrs:{href:e.cancelUrl},on:{click:e.onCancel}},[e._v(e._s(e.trans("buttons.cancel")))])])}),[],!1,null,null,null);t.default=j.exports},WYMz:function(e,t,r){"use strict";var o=r("vDqi"),s=r.n(o),a=r("sEfC"),n=r.n(a),i=r("mwIZ"),l=r.n(i);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var u={name:"nzUserAutocomplete",props:{label:{type:String,default:"User"},placeholder:{type:String,default:"Search for user..."},user:{type:Object,default:null},route:{type:String,default:"api.autocomplete.users.index"},value:{type:String,default:""},error:Boolean,message:{type:String,default:null},except:{},autofocus:Boolean,disabled:Boolean},data:function(){return{data:[],selected:this.user||null,loading:!1}},computed:{icon:function(){return this.selected?"check":null}},watch:{user:function(e){this.selected=e}},methods:{fetchData:n()((function(){var e=this;if(this.value){this.data=[],this.loading=!0;var t={name:this.value};this.except&&(t.except=this.except),s.a.get(route(this.route),{params:t}).then((function(t){t.data.data.forEach((function(t){return e.data.push(t)})),e.loading=!1}),(function(t){e.loading=!1}))}}),500),onSelect:function(e){this.selected=e,this.$emit("select",e)},onInput:function(e){var t=this.getValue(this.selected);t&&t!==e&&this.onSelect(null),this.$emit("input",e),this.fetchData()},focusOnInput:function(){this.$el.querySelector("input").focus()},getValue:function(e){if(e)return"object"===c(e)?l()(e,"full_name"):e}}},d=r("KHd+"),f=Object(d.a)(u,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-field",{staticClass:"nz-user-autocomplete",attrs:{label:e.label,type:e.error?"is-danger":null,message:e.message}},[r("b-field",{attrs:{grouped:""}},[r("b-autocomplete",{attrs:{value:e.value,data:e.data,field:"full_name",loading:e.loading,icon:e.icon,placeholder:e.placeholder,expanded:"",autofocus:e.autofocus,disabled:e.disabled},on:{input:e.onInput,select:e.onSelect},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticClass:"media"},[r("div",{staticClass:"media-content"},[e._v("\n            "+e._s(t.option.full_name)+" "),r("small",[e._v("<"+e._s(t.option.email)+">")])])])]}}])})],1)],1)}),[],!1,null,null,null);t.a=f.exports},"gKG+":function(e,t,r){"use strict";var o=r("0XPj"),s=r.n(o);function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var n=function(){function e(t){for(var r in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t)this[r]=t[r]}var t,r,o;return t=e,(r=[{key:"hasRole",value:function(e){return Array.isArray(e)||(e=[e]),!!s()(this.roles.map((function(e){return e.name})),e).length}}])&&a(t.prototype,r),o&&a(t,o),e}();t.a={data:function(){return{currentUser:new n(window.App.User)}},computed:{isCuratorOrAdmin:function(){return this.currentUser.hasRole(["admin","curator"])}}}},nWYc:function(e,t,r){"use strict";var o=r("+9FD"),s=r.n(o),a=r("dfMu"),n=r.n(a),i=r("T5TR");function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=p(e);if(t){var s=p(this).constructor;r=Reflect.construct(o,arguments,s)}else r=o.apply(this,arguments);return m(this,r)}}function m(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(a,e);var t,r,o,s=f(a);function a(){return c(this,a),s.apply(this,arguments)}return t=a,(r=[{key:"setBoxToRealPosition",value:function(e){var t=this.imageEl.naturalWidth,r=this.imageEl.naturalHeight,o=t/this.imageEl.offsetWidth,s=r/this.imageEl.offsetHeight;this.box=new i.a(Math.round(e.x/o),Math.round(e.y/s),Math.round((e.x+e.width)/o),Math.round((e.y+e.height)/s)),this.redraw()}}])&&u(t.prototype,r),o&&u(t,o),a}(n.a),v={name:"nzImageCropModal",mixins:[r("aa4y").a],props:{canCancel:{type:[Array,Boolean],default:function(){return["escape","x"]}},imageUrl:String,crop:Object},data:function(){return{croppr:null,newCrop:this.crop,preserveRatio:!1}},mounted:function(){document.addEventListener("keydown",this.ctrlIsPressed),document.addEventListener("keyup",this.ctrlIsNotPressed)},beforeDestroy:function(){document.removeEventListener("keydown",this.ctrlIsPressed),document.removeEventListener("keyup",this.ctrlIsNotPressed)},watch:{isActive:function(e){var t=this;this.handleScroll(),this.croppr=null,e&&this.$nextTick((function(){t.croppr=new b(t.$refs.cropModalImage,{onCropEnd:function(e){t.newCrop=e},onInitialize:function(e){t.newCrop&&e.setBoxToRealPosition(t.newCrop)}})}))}},methods:{handleScroll:function(){"undefined"!=typeof window&&(this.savedScrollTop=this.savedScrollTop?this.savedScrollTop:document.documentElement.scrollTop,document.body.classList.toggle("is-noscroll",this.isActive),this.isActive?document.body.style.top="-".concat(this.savedScrollTop,"px"):(document.documentElement.scrollTop=this.savedScrollTop,document.body.style.top=null,this.savedScrollTop=null))},cropImage:function(){this.$emit("update:crop",this.newCrop),this.close()},ctrlIsPressed:function(e){17==e.which&&this.croppr&&(this.croppr.options.aspectRatio=this.croppr.box.height()/this.croppr.box.width())},ctrlIsNotPressed:function(e){17==e.which&&this.croppr&&(this.croppr.options.aspectRatio=null)}}},h=r("KHd+"),_={name:"nzPhotoUpload",components:{NzImageCropModal:Object(h.a)(v,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("transition",{attrs:{name:e.animation}},[e.isActive?r("div",{staticClass:"modal is-active"},[r("div",{staticClass:"modal-background"}),e._v(" "),r("div",{staticClass:"animation-content modal-content",style:{maxWidth:e.newWidth}},[r("img",{ref:"cropModalImage",staticClass:"image",attrs:{src:e.imageUrl,alt:"Cropped image"}})]),e._v(" "),r("button",{staticClass:"modal-close is-large",attrs:{type:"button"},on:{click:function(t){return e.cancel("x")}}}),e._v(" "),r("button",{staticClass:"modal-action",attrs:{type:"button"},on:{click:e.cropImage}},[r("b-icon",{attrs:{icon:"check"}})],1)]):e._e()])}),[],!1,null,null,null).exports,NzImageModal:r("slQF").a},props:{imageUrl:{type:String,default:null},imagePath:{type:String,default:null},imageLicense:{type:[Number,String],default:null},licenses:{type:Object,required:!0},text:String,withLicense:{type:Boolean,default:!0},withCrop:{type:Boolean,default:!0}},data:function(){return{image:{url:this.imageUrl,path:this.imagePath,crop:null,license:this.imageLicense},croppedImageUrl:null,reader:null,uploading:!1,loading:!1,progress:0,hasExisting:!!this.imageUrl,error:null,showCropModal:!1,showModal:!1}},watch:{"image.crop":function(e){this.$emit("cropped",this.image),e?this.cropThumbnail(e):this.croppedImageUrl=null}},computed:{haveImage:function(){return!!this.image.url},thumbnailUrl:function(){return this.croppedImageUrl||this.image.url}},methods:{selectImage:function(){this.$refs.input.click()},onInput:function(e){this.error=null,e&&this.upload(e)},upload:function(e){var t=this;return this.uploading=!0,axios.post(route("api.photo-uploads.store"),this.makeForm(e),{headers:{"Content-Type":"multipart/form-data",Accept:"application/json"},onUploadProgress:function(e){t.progress=Math.floor(100*e.loaded/e.total)}}).then((function(r){t.image.path=r.data.file,t.image.exif=r.data.exif,t.image.license=null,t.uploading=!1,t.progress=0,t.$emit("uploaded",t.image),t.loading=!0,s()(e,(function(e){t.image.url=t.getImageDataUrl(e),t.loading=!1}),{orientation:!0})})).catch(this.handleError)},getImageDataUrl:function(e){var t=e;return t instanceof HTMLCanvasElement||((t=document.createElement("canvas")).setAttribute("width",e.width),t.setAttribute("height",e.height),t.getContext("2d").drawImage(e,0,0)),t.toDataURL()},makeForm:function(e){var t=new FormData;return t.append("file",e),t},remove:function(){var e=this;if(this.hasExisting)return this.hasExisting=!1,this.clearPhoto();axios.delete(route("api.photo-uploads.destroy",this.image.path)).then((function(){e.clearPhoto()}))},clearPhoto:function(){this.$emit("removed",this.image),this.image.path=null,this.image.url=null,this.image.crop=null,this.image.license=null,this.croppedImageUrl=null},handleError:function(e){if(this.uploading=!1,this.loading=!1,this.progress=0,this.image.url=null,this.$el.querySelector('input[type="file"]').value="",!e.response)return this.$buefy.toast.open({duration:5e3,message:e.message,position:"is-top",type:"is-danger"});this.error=e.response.data.errors.file[0]||this.trans("Error")},openCropModal:function(){this.showCropModal=!0},closeCropModal:function(){this.showCropModal=!1},cropThumbnail:function(e){var t=document.createElement("img");t.src=this.image.url;var r=document.createElement("canvas");r.setAttribute("width",e.width),r.setAttribute("height",e.height),r.getContext("2d").drawImage(t,-e.x,-e.y),this.croppedImageUrl=r.toDataURL()},handleLicenseChanged:function(e){this.image.license=e,this.$emit("license-changed",e)}}},g=Object(h.a)(_,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.haveImage?r("div",{staticClass:"card"},[r("div",{staticClass:"card-image"},[r("figure",{staticClass:"has-magnifier has-text-centered",on:{click:function(t){e.showModal=!0}}},[r("img",{staticClass:"max-h-36",attrs:{src:e.thumbnailUrl,alt:"Uploaded photo"}}),e._v(" "),r("div",{staticClass:"image-magnifier"},[r("b-icon",{attrs:{icon:"expand",size:"is-medium"}})],1)])]),e._v(" "),e.haveImage?r("footer",{staticClass:"card-footer"},[r("div",{staticClass:"card-footer-item flex-col"},[r("div",{staticClass:"mb-4 w-full flex justify-between"},[e.withCrop?r("button",{staticClass:"button is-outlined is-small mr-2",attrs:{type:"button"},on:{click:e.openCropModal,close:e.closeCropModal}},[r("b-icon",{attrs:{icon:"crop"}})],1):e._e(),e._v(" "),e.image.path||e.hasExisting?r("button",{staticClass:"delete is-danger is-medium",attrs:{type:"button"},on:{click:e.remove}}):e._e()]),e._v(" "),e.withLicense?r("div",{staticClass:"w-full"},[r("b-select",{attrs:{value:e.image.license,expanded:""},on:{input:e.handleLicenseChanged}},[r("option",{domProps:{value:null}},[e._v(e._s(e.trans("labels.field_observations.default")))]),e._v(" "),e._l(e.licenses,(function(t,o){return r("option",{key:o,domProps:{value:o,textContent:e._s(t)}})}))],2)],1):e._e()])]):e._e(),e._v(" "),e.haveImage?r("nz-image-crop-modal",{attrs:{active:e.showCropModal,crop:e.image.crop,"image-url":e.image.url},on:{"update:active":function(t){e.showCropModal=t},"update:crop":function(t){return e.$set(e.image,"crop",t)}}}):e._e(),e._v(" "),e.showModal?r("nz-image-modal",{attrs:{items:[e.thumbnailUrl]},on:{close:function(t){e.showModal=!1}}}):e._e()],1):r("b-field",{attrs:{message:e.error||null,type:e.error?"is-danger":null,expanded:""}},[r("b-upload",{attrs:{"drag-drop":"",expanded:"",disabled:e.uploading||e.loading},on:{input:e.onInput}},[r("section",{ref:"uploadZone",staticClass:"section is-relative"},[r("div",{staticClass:"has-text-centered"},[r("div",[r("b-icon",{attrs:{icon:"upload",size:"is-medium"}})],1),e._v(" "),e.uploading?r("progress",{staticClass:"progress is-primary is-small",attrs:{max:"100"},domProps:{value:e.progress}},[e._v(e._s(e.progress)+"%")]):e.loading?r("div",[e._v(e._s(e.trans("Loading...")))]):r("div",[e._v(e._s(e.text))])])])])],1)}),[],!1,null,null,null);t.a=g.exports},slQF:function(e,t,r){"use strict";var o={name:"nzImageModal",props:{items:{type:Array,default:function(){return[]}},value:{type:Number,default:0}},data:function(){return{newValue:this.value,active:!1}},computed:{openImage:function(){return this.items[this.newValue]}},watch:{newValue:function(){this.$emit("input",this.newValue)},openImage:{handler:function(e){this.active=Boolean(e)}}},created:function(){document.addEventListener("keyup",this.registerKeyListener)},mounted:function(){this.active=Boolean(this.openImage)},beforeDestroy:function(){document.removeEventListener("keyup",this.registerKeyListener)},methods:{next:function(){var e=this.newValue+1;e>=this.items.length&&(e=0),this.newValue=e},prev:function(){var e=this.newValue-1;e<0&&(e=this.items.length-1),this.newValue=e},registerKeyListener:function(e){var t=e.which||e.keyCode;37===t?this.prev():39===t&&this.next()},onClose:function(e){var t=this;this.active=!1,this.$nextTick((function(){t.$emit("close",e)}))}}},s=r("KHd+"),a=Object(s.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-modal",{attrs:{active:e.active,"can-cancel":["escape","x"]},on:{"update:active":function(t){e.active=t},close:e.onClose}},[r("div",{staticClass:"image-modal"},[r("img",{attrs:{src:e.openImage}}),e._v(" "),e.items.length>1?r("div",{staticClass:"image-modal-navigation"},[r("div",{staticClass:"image-modal-previous",on:{click:e.prev}},[r("i",{staticClass:"fa fa-chevron-left",attrs:{"aria-hidden":"true"}})]),e._v(" "),r("div",{staticClass:"image-modal-next",on:{click:e.next}},[r("i",{staticClass:"fa fa-chevron-right",attrs:{"aria-hidden":"true"}})])]):e._e()])])}),[],!1,null,null,null);t.a=a.exports}}]);
//# sourceMappingURL=24.js.map?id=15e1e373914e8ac75050